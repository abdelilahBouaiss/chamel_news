!function(e){"use strict";e((function(){var t,a;window.jnews.split_toc=window.jnews.split_toc||{},window.jnews.split_toc={init:function(){"object"==typeof jnews&&"object"==typeof jnews.library&&(t=jnews.library,this.registerEvent(!0))},registerEvent:function(t){var a=this;a.container=e("body"),a.window_width=e(window).width(),a.sidefeed_width=e("#jeg_sidecontent").width(),a.admin_bar_height="1"===jnewsoption.admin_bar?e("#wpadminbar").outerHeight():0,a.table=a.container.find(".jeg.table-of-contents"),a.toc_wrapper=a.table.find(".toc-wrapper"),a.toc_wrapper_header=a.table.find(".toc-wrapper-header"),a.table_spacer=a.container.find(".jeg.table-of-contents-spacer"),a.table_links=a.container.find(".toc-wrapper-item-wrap li a"),a.table_height=a.table.outerHeight(),a.floating_table=a.container.find(".jeg.table-of-contents-floating"),a.floating_bar=a.floating_table.find(".floating-bar"),a.floating_icon=a.floating_bar.find("i"),t&&a.recreate(),a.scroll(),a.clicked(),a.scroll_top()},recreate:function(){var e=this;e.table_clone||(e.table_clone=e.table.clone(),e.table_spacer_clone=e.table_spacer.clone(),e.table_links_clone=e.table_links.clone(),e.floating_table_clone=e.floating_table.clone());var n=function(){e.table.replaceWith(e.table_clone.clone()),e.table_spacer.replaceWith(e.table_spacer_clone.clone()),e.table_links.replaceWith(e.table_links_clone.clone()),e.floating_table.replaceWith(e.floating_table_clone.clone()),e.registerEvent(!1),e.move_button()};t.addEvents(t.win,{resize:function(){a&&t.cancelAnimationFrame.call(t.win,a),a=t.requestAnimationFrame.call(t.win,n)}})},scroll:function(){var t=this,a={},n=e(".split-postlist .current_title .pagenum"),o=t.floating_table.find(".floating-navigation"),i=(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),l=e(".entry-content").outerHeight()+e(".entry-content").offset().top;o.length<1||(Array.prototype.forEach.call(n,(function(e){a[e.id]=Math.floor(e.getBoundingClientRect().top+i)-100})),a=(a=Object.entries(a)).sort(((e,t)=>e[1]-t[1])),e(window).on("scroll",(function(){var n=(window.pageYOffset||document.documentElement.scrollTop)-(document.documentElement.clientTop||0),s=e(".jeg.table-of-contents.floating.expanded");if(t.floating_table.removeClass("show"),a.length>0){var c=null;if(n<a[0][1]&&(t.floating_table.removeClass("expanded"),s.removeClass("floating expanded"),t.table_spacer.css("height",0),t.table.css("display",""),t.floating_icon.removeClass("fa-close"),t.floating_icon.addClass("fa-bars"),t.move_button()),n<l){for(var r=0;r<a.length&&n>=a[r][1];r++)c=a[r][0];if(null!=c)for(r=0;r<a.length;r++){var _=e('.jeg.table-of-contents nav a[href*="#'+a[r][0]+'"]').parent(),d=_.find(".toc-wrapper-item-number").text(),f=_.find(".toc-wrapper-item-text").text(),p=20,b=20;a[r][0]==c?(p=jnews.split_toc.float_height(p,i,n),b=jnews.split_toc.float_left(b),_.attr("class","active"),o.html('<a href="#'+a[r][0]+'">'+d+" "+f+"</a>"),o.find("a").on("click",(function(a){if(a.preventDefault(),t.window_width>1024){var n=e(this).attr("href");e([document.documentElement,document.body]).animate({scrollTop:e(".split-container .current_title .pagenum"+n).offset().top},800)}else t.window_width<=768&&t.floating_bar.trigger("click")})),t.floating_table.addClass("show"),t.floating_table.css("top",p),s.css("top",p),0==jnewsoption.rtl&&(t.floating_table.css("left",b),s.css("left",b))):_.attr("class","")}}else t.floating_table.removeClass("expanded"),s.removeClass("show floating expanded"),t.table_spacer.css("height",0),t.table.css("display",""),t.floating_icon.removeClass("fa-close"),t.floating_icon.addClass("fa-bars"),t.move_button()}i=n})))},move_button:function(){var e=this;e.window_width>768?(e.toc_wrapper.prepend(e.toc_wrapper_header),e.floating_table.hasClass("show")&&e.floating_table.hasClass("expanded")?e.toc_wrapper.prepend(e.floating_bar):e.floating_table.prepend(e.floating_bar)):e.window_width<=768&&(e.floating_table.prepend(e.floating_bar),e.floating_table.hasClass("show")&&e.floating_table.hasClass("expanded")?e.floating_table.prepend(e.toc_wrapper_header):e.toc_wrapper.prepend(e.toc_wrapper_header))},float_height:function(e,t,a){var n=this,o=e;return n.sticky_desktop=n.container.find(".jeg_header_sticky .jeg_sticky_nav"),n.sticky_mobile=n.container.find(".jeg_navbar_mobile.jeg_sticky_nav"),n.sticky_desktop_height=n.sticky_desktop.outerHeight(),n.sticky_mobile_height=n.sticky_mobile.outerHeight(),n.sticky_desktop_mode=n.sticky_desktop.data("mode"),n.sticky_mobile_mode=n.sticky_mobile.data("mode"),o=e+n.admin_bar_height,n.window_width>1024?"fixed"==n.sticky_desktop_mode?o+=n.sticky_desktop_height:"scroll"!=n.sticky_desktop_mode&&"pinned"!=n.sticky_desktop_mode||t>a&&(o+=n.sticky_desktop_height):n.window_width>768&&n.window_width<=1024?"fixed"==n.sticky_mobile_mode?o+=n.sticky_mobile_height:"scroll"!=n.sticky_mobile_mode&&"pinned"!=n.sticky_mobile_mode||t>a&&(o+=n.sticky_mobile_height):o="",o},float_left:function(e){var t=this,a=e;return t.window_width>1024?a=e+t.sidefeed_width:t.window_width<=768&&(a=""),a},clicked:function(){var e=this;e.floating_bar.on("click",(function(t){t.preventDefault();var a=e.floating_table.css("top"),n=e.floating_table.css("left");e.floating_table.hasClass("expanded")?(e.floating_table.removeClass("expanded"),e.table.removeClass("floating expanded"),e.table.css("left",n),e.table.css("top",""),e.table.css("display",""),e.table_spacer.css("height",0),e.floating_icon.removeClass("fa-close"),e.floating_icon.addClass("fa-bars")):(e.floating_table.addClass("expanded"),e.table.addClass("floating expanded"),e.floating_icon.removeClass("fa-bars"),e.floating_icon.addClass("fa-close"),0==jnewsoption.rtl?e.table.css("left",n):e.table.css("left",""),e.window_width>768?(e.table.css("top",a),e.table.css("bottom",""),e.table.css("left",n)):(e.table.css("top",""),e.table.css("bottom",0),e.table.css("left","")),"floating"==e.table.data("type")?(e.table_spacer.css("height",0),e.table.css("display","flex")):e.table_spacer.css("height",e.table_height)),e.move_button()}))},scroll_top:function(){this.table_links.each((function(){e(this).on("click",(function(t){t.preventDefault();var a=e(this).attr("href");e([document.documentElement,document.body]).animate({scrollTop:e(".split-container .current_title .pagenum"+a).offset().top},800)}))}))}},jnews.split_toc.init()}))}(jQuery);